---
title: "Slicr and DiceR Project 1"
author: "Spencer Abbot, Chi Cheung, Eric Goldman"
date: "10/4/2017"
output: html_document
---
TEST - EG
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Set Working Directory
#setwd("/Users/Spencer/Project_1")
setwd("/Users/ericg/Desktop/DATS 6101/GITHUB/Project_1")
#setwd("/Users/Chidog/Project_1")
```

```{r map}
#install maps package
install.packages("maps")

map <- get_map(location = 'united states', 
zoom = 4, source = 'stamen') ggmap(map, fullpage = TRUE);

# call library for maps and plotting already installed 
library(ggplot2)
library(maps)

#US map - data
all_states <- map_data("state")

#Read in Lat Long Data from City
citylatlong <- data.frame(read.csv("citylatlong.csv"))

#plot US states with ggplot
p <- ggplot()
p <- p + geom_polygon( data=all_states, 
aes(x=long, y=lat, group = group),colour="white", fill="grey10" )
p;

# plot data points (lat/long) to US map
p + geom_point(data=citylatlong, 
aes(y=LAT, x=LONG, color=Population, size=Population)) +
  ggtitle("US Metro Statistical Areas with Population over 1 million")+
    theme_bw() +
  theme( plot.title=element_text(hjust=0.5),
         axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_blank(),
    panel.background = element_blank(),
    axis.text.y =element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.y=element_blank(),
    axis.ticks.x=element_blank()) +
    xlab("") + 
    ylab("")
```

```{r citystats}
#read in city data csv
library(stats)
citydata <- data.frame(read.csv("CityData.csv"))
head(citydata)
str(citydata)
summary(citydata)

#gather stats for citydata
install.packages("pastecs")
library(pastecs)
stat.desc(citydata)
hist(citydata$ZillowHVI)
boxplot(citydata$CrimeIndex)
boxplot(citydata$Population~citydata$MLB_Team)
hist(citydata$Amazon_HQIndex)
```

```{r anova}
#citydata$F500_HQ <- as.factor(citydata$F500_HQ)
plot(Amazon_HQIndex ~ F500_HQ, data=citydata)
model.degree <- aov(Population~MLB_Team, data = citydata)
hist(model.degree$residuals, main = "Hist of Res", xlab = "Residuals")
summary(model.degree)
TukeyHSD(model.degree)
plot(citydata)
plot(citydata$Amazon_HQIndex, citydata$CrimeIndex)
cor(citydata$ZillowHVI,citydata$CrimeIndex, method="pearson")
cor(citydata$Population,citydata$F500_HQ, method="pearson")
cor(citydata[,2:4], method="pearson")
qqnorm(citydata[,7])
qqline (citydata[,7], col=2)
```

```{r, eval=TRUE}
x <- lm(Population~F500_HQ, data = citydata)
summary(x)
```
